<!DOCTYPE html>
<html>
<head>
    <title>RTL波形查看器 - tpu_mac_array_test.vcd</title>
    <meta charset="UTF-8">
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 1600px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header { 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white; 
            padding: 25px; 
            text-align: center;
        }
        .header h1 { margin: 0; font-size: 2.5em; }
        .controls { 
            background: #f8f9fa; 
            padding: 20px; 
            border-bottom: 1px solid #dee2e6;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        .control-group { 
            display: flex; 
            align-items: center; 
            gap: 10px;
        }
        .control-group label { 
            font-weight: bold; 
            color: #495057;
        }
        .control-group input, .control-group select { 
            padding: 8px 12px; 
            border: 1px solid #ced4da; 
            border-radius: 5px;
            font-size: 14px;
        }
        .btn { 
            padding: 10px 20px; 
            background: #1e3c72; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        .btn:hover { background: #2a5298; }
        .btn.secondary { background: #6c757d; }
        .btn.secondary:hover { background: #545b62; }
        .signal-category { 
            margin: 20px; 
            border: 1px solid #dee2e6; 
            border-radius: 8px;
            overflow: hidden;
        }
        .category-header { 
            background: #e9ecef; 
            padding: 15px; 
            font-weight: bold; 
            color: #2c3e50;
            border-bottom: 1px solid #dee2e6;
        }
        .signal-row { 
            display: flex; 
            align-items: center; 
            padding: 10px 15px; 
            border-bottom: 1px solid #f8f9fa;
        }
        .signal-row:hover { background: #f8f9fa; }
        .signal-name { 
            width: 200px; 
            font-weight: bold; 
            color: #2c3e50;
            font-family: monospace;
        }
        .signal-canvas { 
            flex: 1; 
            height: 60px; 
            border: 1px solid #dee2e6; 
            border-radius: 5px;
            background: white;
            margin: 0 10px;
        }
        .signal-info { 
            width: 150px; 
            font-size: 12px; 
            color: #6c757d;
            text-align: right;
        }
        .timeline { 
            height: 40px; 
            background: #2c3e50; 
            color: white; 
            display: flex; 
            align-items: center; 
            padding: 0 20px;
            font-family: monospace;
            font-size: 14px;
        }
        .stats { 
            background: #e9ecef; 
            padding: 20px; 
            border-top: 1px solid #dee2e6;
        }
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px;
        }
        .stat-card { 
            background: white; 
            padding: 15px; 
            border-radius: 8px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-card h4 { 
            margin: 0 0 10px 0; 
            color: #2c3e50;
        }
        .stat-value { 
            font-size: 1.5em; 
            font-weight: bold; 
            color: #1e3c72;
        }
        .clock { color: #e74c3c; }
        .control { color: #f39c12; }
        .data { color: #3498db; }
        .status { color: #27ae60; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌊 RTL波形查看器</h1>
            <p>文件: tpu_mac_array_test.vcd | 大小: 10052 bytes</p>
            <p>RTL模块: TPU/VPU AI加速器</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label>时间范围:</label>
                <input type="number" id="timeStart" value="0" placeholder="开始时间(ps)">
                <span>-</span>
                <input type="number" id="timeEnd" value="1000000" placeholder="结束时间(ps)">
            </div>
            <div class="control-group">
                <label>缩放:</label>
                <select id="zoomLevel">
                    <option value="1">1x</option>
                    <option value="2">2x</option>
                    <option value="4">4x</option>
                    <option value="8">8x</option>
                    <option value="16">16x</option>
                </select>
            </div>
            <button class="btn" onclick="updateWaveforms()">🔄 更新波形</button>
            <button class="btn secondary" onclick="exportData()">💾 导出数据</button>
            <button class="btn secondary" onclick="analyzeSignals()">📊 信号分析</button>
        </div>
        
        <div class="timeline" id="timeline">
            时间轴将在这里显示
        </div>
        
        <div class="signal-category">
            <div class="category-header clock">🕐 时钟信号</div>
            <div id="clockSignals"></div>
        </div>
        
        <div class="signal-category">
            <div class="category-header control">🎛️ 控制信号</div>
            <div id="controlSignals"></div>
        </div>
        
        <div class="signal-category">
            <div class="category-header data">📊 数据信号</div>
            <div id="dataSignals"></div>
        </div>
        
        <div class="signal-category">
            <div class="category-header status">📈 状态信号</div>
            <div id="statusSignals"></div>
        </div>
        
        <div class="stats">
            <h3>📊 RTL波形统计信息</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>时钟信号</h4>
                    <div class="stat-value" id="clockCount">2</div>
                </div>
                <div class="stat-card">
                    <h4>控制信号</h4>
                    <div class="stat-value" id="controlCount">2</div>
                </div>
                <div class="stat-card">
                    <h4>数据信号</h4>
                    <div class="stat-value" id="dataCount">9</div>
                </div>
                <div class="stat-card">
                    <h4>状态信号</h4>
                    <div class="stat-value" id="statusCount">98</div>
                </div>
                <div class="stat-card">
                    <h4>总信号数</h4>
                    <div class="stat-value">111</div>
                </div>
                <div class="stat-card">
                    <h4>文件大小</h4>
                    <div class="stat-value">10052 B</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // RTL波形数据
        const rtlData = {
  "clock_signals": [
    {
      "id": "\"",
      "name": "CLK_PERIOD",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0xa"
        ]
      ]
    },
    {
      "id": "$",
      "name": "clk",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ],
        [
          5000,
          "1"
        ],
        [
          10000,
          "0"
        ],
        [
          15000,
          "1"
        ],
        [
          20000,
          "0"
        ],
        [
          25000,
          "1"
        ],
        [
          30000,
          "0"
        ],
        [
          35000,
          "1"
        ],
        [
          40000,
          "0"
        ],
        [
          45000,
          "1"
        ],
        [
          50000,
          "0"
        ],
        [
          55000,
          "1"
        ],
        [
          60000,
          "0"
        ],
        [
          65000,
          "1"
        ],
        [
          70000,
          "0"
        ],
        [
          75000,
          "1"
        ],
        [
          80000,
          "0"
        ],
        [
          85000,
          "1"
        ],
        [
          90000,
          "0"
        ],
        [
          95000,
          "1"
        ],
        [
          100000,
          "0"
        ],
        [
          105000,
          "1"
        ],
        [
          110000,
          "0"
        ],
        [
          115000,
          "1"
        ],
        [
          120000,
          "0"
        ],
        [
          125000,
          "1"
        ],
        [
          130000,
          "0"
        ],
        [
          135000,
          "1"
        ],
        [
          140000,
          "0"
        ],
        [
          145000,
          "1"
        ],
        [
          150000,
          "0"
        ],
        [
          155000,
          "1"
        ],
        [
          160000,
          "0"
        ],
        [
          165000,
          "1"
        ],
        [
          170000,
          "0"
        ],
        [
          175000,
          "1"
        ],
        [
          180000,
          "0"
        ],
        [
          185000,
          "1"
        ],
        [
          190000,
          "0"
        ],
        [
          195000,
          "1"
        ],
        [
          200000,
          "0"
        ],
        [
          205000,
          "1"
        ],
        [
          210000,
          "0"
        ],
        [
          215000,
          "1"
        ],
        [
          220000,
          "0"
        ],
        [
          225000,
          "1"
        ],
        [
          230000,
          "0"
        ],
        [
          235000,
          "1"
        ],
        [
          240000,
          "0"
        ],
        [
          245000,
          "1"
        ],
        [
          250000,
          "0"
        ],
        [
          255000,
          "1"
        ],
        [
          260000,
          "0"
        ],
        [
          265000,
          "1"
        ],
        [
          270000,
          "0"
        ],
        [
          275000,
          "1"
        ]
      ]
    }
  ],
  "control_signals": [
    {
      "id": ")",
      "name": "rst_n",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ],
        [
          35000,
          "1"
        ]
      ]
    },
    {
      "id": "*",
      "name": "enable",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ],
        [
          95000,
          "1"
        ],
        [
          125000,
          "0"
        ],
        [
          165000,
          "1"
        ],
        [
          195000,
          "0"
        ],
        [
          215000,
          "1"
        ],
        [
          225000,
          "0"
        ]
      ]
    }
  ],
  "data_signals": [
    {
      "id": "#",
      "name": "DATA_WIDTH",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0x20"
        ]
      ]
    },
    {
      "id": "5",
      "name": "data_type",
      "type": "wire",
      "width": "2",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "6",
      "name": "DATA_WIDTH",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0x20"
        ]
      ]
    },
    {
      "id": "M",
      "name": "data_type",
      "type": "wire",
      "width": "2",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "N",
      "name": "DATA_WIDTH",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0x20"
        ]
      ]
    },
    {
      "id": "e",
      "name": "data_type",
      "type": "wire",
      "width": "2",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "f",
      "name": "DATA_WIDTH",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0x20"
        ]
      ]
    },
    {
      "id": "}",
      "name": "data_type",
      "type": "wire",
      "width": "2",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "~",
      "name": "DATA_WIDTH",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0x20"
        ]
      ]
    }
  ],
  "status_signals": [
    {
      "id": "!",
      "name": "ARRAY_SIZE",
      "type": "parameter",
      "width": "32",
      "values": [
        [
          0,
          "0x4"
        ]
      ]
    },
    {
      "id": "%",
      "name": "computation_done",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "x"
        ],
        [
          5000,
          "0"
        ],
        [
          105000,
          "1"
        ],
        [
          125000,
          "0"
        ],
        [
          175000,
          "1"
        ],
        [
          195000,
          "0"
        ]
      ]
    },
    {
      "id": "&",
      "name": "cycles_count",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ],
        [
          5000,
          "0x0"
        ],
        [
          45000,
          "0x1"
        ],
        [
          55000,
          "0x2"
        ],
        [
          65000,
          "0x3"
        ],
        [
          75000,
          "0x4"
        ],
        [
          85000,
          "0x5"
        ],
        [
          95000,
          "0x6"
        ],
        [
          105000,
          "0x7"
        ],
        [
          115000,
          "0x8"
        ],
        [
          125000,
          "0x9"
        ],
        [
          135000,
          "0xa"
        ],
        [
          145000,
          "0xb"
        ],
        [
          155000,
          "0xc"
        ],
        [
          165000,
          "0xd"
        ],
        [
          175000,
          "0xe"
        ],
        [
          185000,
          "0xf"
        ],
        [
          195000,
          "0x10"
        ],
        [
          205000,
          "0x11"
        ],
        [
          215000,
          "0x12"
        ],
        [
          225000,
          "0x13"
        ],
        [
          235000,
          "0x14"
        ],
        [
          245000,
          "0x15"
        ],
        [
          255000,
          "0x16"
        ],
        [
          265000,
          "0x17"
        ],
        [
          275000,
          "0x18"
        ]
      ]
    },
    {
      "id": "'",
      "name": "load_weight",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ],
        [
          75000,
          "1"
        ],
        [
          95000,
          "0"
        ],
        [
          145000,
          "1"
        ],
        [
          165000,
          "0"
        ]
      ]
    },
    {
      "id": "(",
      "name": "ops_count",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ],
        [
          5000,
          "0x0"
        ],
        [
          105000,
          "0x4"
        ],
        [
          115000,
          "0x8"
        ],
        [
          175000,
          "0xc"
        ],
        [
          185000,
          "0x10"
        ]
      ]
    },
    {
      "id": "+",
      "name": "start_cycles",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ],
        [
          215000,
          "0x11"
        ]
      ]
    },
    {
      "id": ",",
      "name": "start_ops",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ],
        [
          215000,
          "0x10"
        ]
      ]
    },
    {
      "id": "-",
      "name": "i",
      "type": "integer",
      "width": "32",
      "values": [
        [
          0,
          "0x4"
        ],
        [
          75000,
          "0x4"
        ],
        [
          95000,
          "0x4"
        ],
        [
          145000,
          "0x4"
        ],
        [
          165000,
          "0x4"
        ],
        [
          215000,
          "0x4"
        ]
      ]
    },
    {
      "id": ".",
      "name": "pass_count",
      "type": "integer",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          145000,
          "0x1"
        ],
        [
          215000,
          "0x2"
        ],
        [
          275000,
          "0x3"
        ]
      ]
    },
    {
      "id": "/",
      "name": "test_count",
      "type": "integer",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x1"
        ],
        [
          145000,
          "0x2"
        ],
        [
          215000,
          "0x3"
        ]
      ]
    },
    {
      "id": "0",
      "name": "g",
      "type": "parameter",
      "width": "2",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "1",
      "name": "a_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "2",
      "name": "accumulate",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "3",
      "name": "b_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "4",
      "name": "c_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "7",
      "name": "a_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "8",
      "name": "a_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "9",
      "name": "a_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3"
        ],
        [
          165000,
          "0x2"
        ],
        [
          215000,
          "0x1"
        ]
      ]
    },
    {
      "id": ":",
      "name": "a_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": ";",
      "name": "acc_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "<",
      "name": "b_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "=",
      "name": "b_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": ">",
      "name": "b_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5"
        ],
        [
          145000,
          "0x7"
        ]
      ]
    },
    {
      "id": "?",
      "name": "b_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x5050505"
        ],
        [
          165000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "@",
      "name": "c_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          105000,
          "0xf"
        ],
        [
          165000,
          "0x15"
        ],
        [
          175000,
          "0xe"
        ]
      ]
    },
    {
      "id": "A",
      "name": "mult_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "B",
      "name": "mult_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "C",
      "name": "mult_int8",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "D",
      "name": "mult_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "E",
      "name": "overflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "F",
      "name": "underflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "G",
      "name": "weight_reg",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "H",
      "name": "g",
      "type": "parameter",
      "width": "2",
      "values": [
        [
          0,
          "0x1"
        ]
      ]
    },
    {
      "id": "I",
      "name": "a_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "J",
      "name": "accumulate",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "K",
      "name": "b_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "L",
      "name": "c_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "O",
      "name": "a_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "P",
      "name": "a_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "Q",
      "name": "a_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3"
        ],
        [
          165000,
          "0x2"
        ],
        [
          215000,
          "0x1"
        ]
      ]
    },
    {
      "id": "R",
      "name": "a_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "S",
      "name": "acc_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "T",
      "name": "b_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "U",
      "name": "b_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "V",
      "name": "b_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5"
        ],
        [
          145000,
          "0x7"
        ]
      ]
    },
    {
      "id": "W",
      "name": "b_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x5050505"
        ],
        [
          165000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "X",
      "name": "c_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          105000,
          "0xf"
        ],
        [
          165000,
          "0x15"
        ],
        [
          175000,
          "0xe"
        ]
      ]
    },
    {
      "id": "Y",
      "name": "mult_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "Z",
      "name": "mult_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "[",
      "name": "mult_int8",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "\\",
      "name": "mult_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "]",
      "name": "overflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "^",
      "name": "underflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "_",
      "name": "weight_reg",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "`",
      "name": "g",
      "type": "parameter",
      "width": "3",
      "values": [
        [
          0,
          "0x2"
        ]
      ]
    },
    {
      "id": "a",
      "name": "a_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "b",
      "name": "accumulate",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "c",
      "name": "b_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "d",
      "name": "c_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "g",
      "name": "a_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "h",
      "name": "a_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "i",
      "name": "a_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3"
        ],
        [
          165000,
          "0x2"
        ],
        [
          215000,
          "0x1"
        ]
      ]
    },
    {
      "id": "j",
      "name": "a_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "k",
      "name": "acc_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "l",
      "name": "b_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "m",
      "name": "b_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "n",
      "name": "b_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5"
        ],
        [
          145000,
          "0x7"
        ]
      ]
    },
    {
      "id": "o",
      "name": "b_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x5050505"
        ],
        [
          165000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "p",
      "name": "c_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          105000,
          "0xf"
        ],
        [
          165000,
          "0x15"
        ],
        [
          175000,
          "0xe"
        ]
      ]
    },
    {
      "id": "q",
      "name": "mult_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "r",
      "name": "mult_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "s",
      "name": "mult_int8",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "t",
      "name": "mult_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "u",
      "name": "overflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "v",
      "name": "underflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "w",
      "name": "weight_reg",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "x",
      "name": "g",
      "type": "parameter",
      "width": "3",
      "values": [
        [
          0,
          "0x3"
        ]
      ]
    },
    {
      "id": "y",
      "name": "a_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "z",
      "name": "accumulate",
      "type": "wire",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "{",
      "name": "b_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "|",
      "name": "c_in",
      "type": "wire",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ]
      ]
    },
    {
      "id": "!\"",
      "name": "a_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "\"\"",
      "name": "a_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "#\"",
      "name": "a_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3"
        ],
        [
          165000,
          "0x2"
        ],
        [
          215000,
          "0x1"
        ]
      ]
    },
    {
      "id": "$\"",
      "name": "a_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x3030303"
        ],
        [
          165000,
          "0x2020202"
        ],
        [
          215000,
          "0x1010101"
        ]
      ]
    },
    {
      "id": "%\"",
      "name": "acc_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "&\"",
      "name": "b_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "'\"",
      "name": "b_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "(\"",
      "name": "b_int8",
      "type": "reg",
      "width": "8",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5"
        ],
        [
          145000,
          "0x7"
        ]
      ]
    },
    {
      "id": ")\"",
      "name": "b_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0x5050505"
        ],
        [
          165000,
          "0x7070707"
        ]
      ]
    },
    {
      "id": "*\"",
      "name": "c_out",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          105000,
          "0xf"
        ],
        [
          165000,
          "0x15"
        ],
        [
          175000,
          "0xe"
        ]
      ]
    },
    {
      "id": "+\"",
      "name": "mult_fp16",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": ",\"",
      "name": "mult_fp32",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "x"
        ]
      ]
    },
    {
      "id": "-\"",
      "name": "mult_int8",
      "type": "reg",
      "width": "16",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": ".\"",
      "name": "mult_result",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          95000,
          "0xf"
        ],
        [
          145000,
          "0x15"
        ],
        [
          165000,
          "0xe"
        ],
        [
          215000,
          "0x7"
        ]
      ]
    },
    {
      "id": "/\"",
      "name": "overflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "0\"",
      "name": "underflow",
      "type": "reg",
      "width": "1",
      "values": [
        [
          0,
          "0"
        ]
      ]
    },
    {
      "id": "1\"",
      "name": "weight_reg",
      "type": "reg",
      "width": "32",
      "values": [
        [
          0,
          "0x0"
        ],
        [
          75000,
          "0x5050505"
        ],
        [
          145000,
          "0x7070707"
        ]
      ]
    }
  ]
};
        
        // 全局变量
        let currentTimeStart = 0;
        let currentTimeEnd = 1000000;
        let currentZoom = 1;
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            calculateTimeRange();
            renderAllSignals();
        });
        
        function calculateTimeRange() {
            let maxTime = 0;
            
            // 计算所有信号的最大时间
            Object.values(rtlData).forEach(category => {
                category.forEach(signal => {
                    signal.values.forEach(([time, value]) => {
                        maxTime = Math.max(maxTime, time);
                    });
                });
            });
            
            document.getElementById('timeEnd').value = maxTime;
            currentTimeEnd = maxTime;
        }
        
        function renderAllSignals() {
            renderSignalCategory('clockSignals', rtlData.clock_signals, '#e74c3c');
            renderSignalCategory('controlSignals', rtlData.control_signals, '#f39c12');
            renderSignalCategory('dataSignals', rtlData.data_signals, '#3498db');
            renderSignalCategory('statusSignals', rtlData.status_signals, '#27ae60');
            updateTimeline();
        }
        
        function renderSignalCategory(containerId, signals, color) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            signals.forEach(signal => {
                const signalRow = document.createElement('div');
                signalRow.className = 'signal-row';
                
                const signalName = document.createElement('div');
                signalName.className = 'signal-name';
                signalName.textContent = signal.name;
                
                const canvas = document.createElement('canvas');
                canvas.className = 'signal-canvas';
                canvas.width = 1000;
                canvas.height = 60;
                
                const signalInfo = document.createElement('div');
                signalInfo.className = 'signal-info';
                signalInfo.innerHTML = `
                    类型: ${signal.type}<br>
                    宽度: ${signal.width}<br>
                    变化: ${signal.values.length}
                `;
                
                signalRow.appendChild(signalName);
                signalRow.appendChild(canvas);
                signalRow.appendChild(signalInfo);
                container.appendChild(signalRow);
                
                // 绘制波形
                drawRTLWaveform(canvas, signal, color);
            });
        }
        
        function drawRTLWaveform(canvas, signal, color) {
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // 清空画布
            ctx.clearRect(0, 0, width, height);
            
            // 绘制背景网格
            ctx.strokeStyle = '#f0f0f0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const x = (i / 10) * width;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            // 绘制波形
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.font = '10px monospace';
            
            if (signal.values.length === 0) return;
            
            let lastValue = '0';
            let lastX = 0;
            let lastY = height - 10;
            
            ctx.beginPath();
            
            signal.values.forEach(([time, value], index) => {
                const x = ((time - currentTimeStart) / (currentTimeEnd - currentTimeStart)) * width;
                
                if (x >= 0 && x <= width) {
                    let y;
                    
                    // 根据信号类型确定Y位置
                    if (signal.width === '1') {
                        // 单bit信号
                        y = value === '1' || value === '0x1' ? 10 : height - 10;
                    } else {
                        // 多bit信号，显示为数字波形
                        y = height / 2;
                    }
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        // 绘制从上一个值到当前时间的水平线
                        ctx.lineTo(x, lastY);
                        // 绘制垂直跳变线
                        ctx.lineTo(x, y);
                    }
                    
                    // 绘制值标签
                    if (signal.width !== '1' || (x - lastX) > 50) {
                        ctx.fillStyle = color;
                        let displayValue = value;
                        if (typeof value === 'string' && value.startsWith('0x')) {
                            displayValue = value;
                        } else if (signal.width !== '1') {
                            displayValue = `0x${value}`;
                        }
                        ctx.fillText(displayValue, x + 2, y - 5);
                    }
                    
                    lastX = x;
                    lastY = y;
                    lastValue = value;
                }
            });
            
            // 延伸到画布末尾
            ctx.lineTo(width, lastY);
            ctx.stroke();
        }
        
        function updateTimeline() {
            const timeline = document.getElementById('timeline');
            const timeRange = currentTimeEnd - currentTimeStart;
            const step = Math.pow(10, Math.floor(Math.log10(timeRange / 10)));
            
            let timelineText = '';
            for (let t = currentTimeStart; t <= currentTimeEnd; t += step) {
                timelineText += `${t}ps `;
            }
            
            timeline.textContent = timelineText;
        }
        
        function updateWaveforms() {
            currentTimeStart = parseInt(document.getElementById('timeStart').value) || 0;
            currentTimeEnd = parseInt(document.getElementById('timeEnd').value) || 1000000;
            currentZoom = parseInt(document.getElementById('zoomLevel').value) || 1;
            
            renderAllSignals();
        }
        
        function exportData() {
            const dataStr = JSON.stringify(rtlData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'tpu_mac_array_test_rtl_waveform_data.json';
            link.click();
            
            URL.revokeObjectURL(url);
        }
        
        function analyzeSignals() {
            let analysis = "RTL信号分析报告\n";
            analysis += "==================\n\n";
            
            Object.entries(rtlData).forEach(([category, signals]) => {
                analysis += `${category.replace('_', ' ').toUpperCase()}: ${signals.length} 个信号\n`;
                signals.forEach(signal => {
                    analysis += `  - ${signal.name} (${signal.type}, ${signal.width}bit, ${signal.values.length} 变化)\n`;
                });
                analysis += "\n";
            });
            
            alert(analysis);
        }
    </script>
</body>
</html>