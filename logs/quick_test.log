/Library/Python/3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/Library/Python/3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
🍎 检测到macOS系统，启用仿真模式
🚀 初始化RISC-V AI后端 (macOS仿真模式)
🚀 初始化RISC-V AI加速器仿真器...
📁 虚拟设备文件创建在: /var/folders/x1/dw9cr25s1j5606xy8x6yg_yh0000gn/T/riscv_ai_simulator
✅ 仿真器初始化成功
   TPU数量: 2
   VPU数量: 2
   虚拟内存: 8GB
✅ RISC-V AI后端初始化成功
⚠️  注意: 运行在仿真模式下，性能数据仅供参考
✓ RISC-V AI后端可用
🚀 初始化RISC-V AI后端 (macOS仿真模式)
🚀 初始化RISC-V AI加速器仿真器...
📁 虚拟设备文件创建在: /var/folders/x1/dw9cr25s1j5606xy8x6yg_yh0000gn/T/riscv_ai_simulator
✅ 仿真器初始化成功
   TPU数量: 2
   VPU数量: 2
   虚拟内存: 8GB
✅ RISC-V AI后端初始化成功
⚠️  注意: 运行在仿真模式下，性能数据仅供参考
✓ 检测到 2 个TPU
✓ 检测到 2 个VPU
开始RISC-V AI加速器芯片综合测试
==================================================

=== 基本操作测试 ===
测试矩阵乘法...
  64x64: CPU=0.0046s, AI=0.0040s, 加速比=1.17x, 准确性=✗
  128x128: CPU=0.0000s, AI=0.0009s, 加速比=0.02x, 准确性=✗
  256x256: CPU=0.0001s, AI=0.0033s, 加速比=0.03x, 准确性=✗
  512x512: CPU=0.0005s, AI=0.0131s, 加速比=0.03x, 准确性=✗
  1024x1024: CPU=0.0055s, AI=0.0524s, 加速比=0.10x, 准确性=✗

测试2D卷积...
  3x32x32->16: CPU=0.0050s, AI=0.0008s, 加速比=6.18x, 准确性=✗
  32x64x64->64: CPU=0.0013s, AI=0.0094s, 加速比=0.14x, 准确性=✗
  64x128x128->128: CPU=0.0178s, AI=0.0821s, 加速比=0.22x, 准确性=✗

测试激活函数...
  ReLU(1000): CPU=0.000967s, AI=0.000190s, 加速比=5.09x
  ReLU(10000): CPU=0.000007s, AI=0.000451s, 加速比=0.02x
  ReLU(100000): CPU=0.000059s, AI=0.002736s, 加速比=0.02x

=== 神经网络模型测试 ===
CPU基准测试...
CPU推理时间: 0.0689s (100次)
加载模型到RISC-V AI运行时...
📥 加载模型: simple_net
⚡ 模型优化已启用 (仿真模式)
RISC-V AI加速推理测试...
AI推理时间: 0.2047s (100次)
加速比: 0.34x
准确性: ✓
运行详细性能基准...
🏁 基准测试模型: simple_net (1000次迭代)
🔥 预热 (100次)...
⏱️  基准测试 (1000次)...
  进度: 100/1000
  进度: 200/1000
  进度: 300/1000
  进度: 400/1000
  进度: 500/1000
  进度: 600/1000
  进度: 700/1000
  进度: 800/1000
  进度: 900/1000
  进度: 1000/1000
📊 基准测试完成:
  平均时间: 0.002124s
  标准差: 0.000386s
  吞吐量: 470.86 inferences/sec
平均推理时间: 0.002124s
吞吐量: 470.86 inferences/sec
标准差: 0.000386s

=== 量化测试 ===
准备校准数据...

测试INT8量化...
🔢 量化模型 (方案: int8)
✅ 模型量化完成: int8
  FP32时间: 0.037845s
  INT8时间: 0.023867s
  加速比: 1.59x
  准确性损失: 0.000000

测试INT16量化...
🔢 量化模型 (方案: int16)
✅ 模型量化完成: int16
  FP32时间: 0.022715s
  INT16时间: 0.021899s
  加速比: 1.04x
  准确性损失: 0.000000

=== 内存性能测试 ===
测试 1MB 内存传输...
  分配时间: 0.000026s
  H2D传输: 0.001103s (906.68 MB/s)
  D2H传输: 0.004206s (237.76 MB/s)
测试 10MB 内存传输...
  分配时间: 0.000010s
  H2D传输: 0.001625s (6153.62 MB/s)
  D2H传输: 0.042091s (237.58 MB/s)
测试 100MB 内存传输...
  分配时间: 0.000027s
  H2D传输: 0.021192s (4718.75 MB/s)
  D2H传输: 0.471000s (212.31 MB/s)
测试 1000MB 内存传输...
  分配时间: 0.000336s
  H2D传输: 0.734578s (1361.33 MB/s)
  D2H传输: 6.388016s (156.54 MB/s)

=== 并发执行测试 ===
测试 2 个TPU并发执行...
  串行时间: 0.0306s
  并发时间: 0.0303s
  并发加速比: 1.01x

==================================================
测试报告摘要
==================================================
✓ RISC-V AI后端: 可用
✓ TPU数量: 2
✓ VPU数量: 2

基本操作性能:
  矩阵乘法平均加速比: 0.27x
  矩阵乘法最大加速比: 1.17x
  卷积平均加速比: 2.18x
  卷积最大加速比: 6.18x

神经网络推理加速比: 0.34x
推理吞吐量: 470.86 inferences/sec

量化性能:
  INT8: 加速比=1.59x, 准确性损失=0.000000
  INT16: 加速比=1.04x, 准确性损失=0.000000

详细结果已保存到: test_results/quick_results.json

测试完成!
🧹 仿真器资源已清理
🧹 RISC-V AI后端已清理
